mutate(distance = ((trait.1.anne * trait.1.wentworth) +
(trait.2.anne * trait.2.wentworth)) /
((trait.1.anne^2 + trait.2.anne^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2))
) %>%
ggplot(aes(chapter,distance))+
geom_area() +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
full_join(data_to_plot %>% filter(label %in% "anne") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".anne",".wentworth")) %>%
mutate(distance = ((trait.1.anne * trait.1.wentworth) +
(trait.2.anne * trait.2.wentworth)) /
((trait.1.anne^2 + trait.2.anne^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2))
) %>%
ggplot(aes(chapter,distance))+
geom_area() +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
data_to_plot
full_join(data_to_plot %>% filter(label %in% "anne") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".anne",".wentworth"))
data_to_plot
data_to_plot %>% filter(label %in% "anne") %>% select(-label,-magnitude)
data_to_plot %>% filter(label %in% "anne")
data_to_plot %>% filter(label %in% "ann")
data_to_plot %>% filter(label %in% "wentworth")
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2))
) %>%
ggplot(aes(chapter,distance))+
geom_area() +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2))
) %>%
filter(chapter != 0) %>%
ggplot(aes(chapter,distance))+
geom_area() +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
?geom_area
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2))
) %>%
filter(chapter != 0) %>%
ggplot(aes(chapter,distance))+
geom_area(na.rm = T) +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)+
(trait.3.ann * trait.3.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2 + trait.3.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2 + trait.3.wentworth^2))
) %>%
filter(chapter != 0) %>%
ggplot(aes(chapter,distance))+
geom_area(na.rm = T) +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)+
(trait.3.ann * trait.3.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2 + trait.3.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2 + trait.3.wentworth^2))
) %>%
filter(chapter != 0) %>%
ggplot(aes(chapter,distance))
+
geom_area(na.rm = T)
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)+
(trait.3.ann * trait.3.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2 + trait.3.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2 + trait.3.wentworth^2))
) %>%
filter(chapter != 0) %>%
ggplot(aes(chapter,distance)) +
geom_area(na.rm = T)
?position_stack
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)+
(trait.3.ann * trait.3.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2 + trait.3.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2 + trait.3.wentworth^2))
) %>%
filter(chapter != 0) %>%
ggplot(aes(chapter,distance)) +
geom_area(position = "fill", na.rm = T) +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)+
(trait.3.ann * trait.3.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2 + trait.3.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2 + trait.3.wentworth^2))
) %>%
filter(chapter != 0) %>%
ggplot(aes(chapter,distance)) +
geom_area(position = "identity", na.rm = T) +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)+
(trait.3.ann * trait.3.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2 + trait.3.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2 + trait.3.wentworth^2))
) %>%
filter(chapter != 0)
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)+
(trait.3.ann * trait.3.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2 + trait.3.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2 + trait.3.wentworth^2))
) %>%
filter(chapter != 0) -> distance_df
distance_df$distance
```{r}
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance_cosine = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)+
(trait.3.ann * trait.3.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2 + trait.3.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2 + trait.3.wentworth^2))
,
distance_euclid = sqrt((trait.1.ann - trait.1.wentworth)^2 +
(trait.2.ann - trait.2.wentworth)^2 +
(trait.3.ann - trait.3.wentworth)^2)
) %>%
filter(chapter != 0) -> distance_df
%>%
ggplot(aes(chapter,distance_euclid)) +
geom_area(position = "identity", na.rm = T) +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance_cosine = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)+
(trait.3.ann * trait.3.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2 + trait.3.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2 + trait.3.wentworth^2))
,
distance_euclid = sqrt((trait.1.ann - trait.1.wentworth)^2 +
(trait.2.ann - trait.2.wentworth)^2 +
(trait.3.ann - trait.3.wentworth)^2)
) %>%
filter(chapter != 0) -> distance_df
distance_df %>%
ggplot(aes(chapter,distance_euclid)) +
geom_area(position = "identity", na.rm = T) +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance_cosine = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)+
(trait.3.ann * trait.3.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2 + trait.3.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2 + trait.3.wentworth^2))
,
distance_euclid = sqrt((trait.1.ann - trait.1.wentworth)^2 +
(trait.2.ann - trait.2.wentworth)^2 +
(trait.3.ann - trait.3.wentworth)^2)
) %>%
filter(chapter != 0) -> distance_df
distance_df %>%
ggplot(aes(chapter,distance_euclid)) +
geom_area(position = "dodge", na.rm = T) +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance_cosine = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)+
(trait.3.ann * trait.3.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2 + trait.3.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2 + trait.3.wentworth^2))
,
distance_euclid = sqrt((trait.1.ann - trait.1.wentworth)^2 +
(trait.2.ann - trait.2.wentworth)^2 +
(trait.3.ann - trait.3.wentworth)^2)
) %>%
filter(chapter != 0) -> distance_df
distance_df %>%
ggplot(aes(chapter,distance_euclid)) +
geom_area(na.rm = T) +
position_dodge(width = binwidth/2)
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance_cosine = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)+
(trait.3.ann * trait.3.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2 + trait.3.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2 + trait.3.wentworth^2))
,
distance_euclid = sqrt((trait.1.ann - trait.1.wentworth)^2 +
(trait.2.ann - trait.2.wentworth)^2 +
(trait.3.ann - trait.3.wentworth)^2)
) %>%
filter(chapter != 0) -> distance_df
distance_df %>%
ggplot(aes(chapter,distance_euclid)) +
geom_area(na.rm = T) +
position_dodge(width = binwidth/2) +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance_cosine = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)+
(trait.3.ann * trait.3.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2 + trait.3.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2 + trait.3.wentworth^2))
,
distance_euclid = sqrt((trait.1.ann - trait.1.wentworth)^2 +
(trait.2.ann - trait.2.wentworth)^2 +
(trait.3.ann - trait.3.wentworth)^2)
) %>%
filter(chapter != 0) -> distance_df
distance_df %>%
ggplot(aes(chapter,distance_euclid)) +
geom_area(na.rm = T) +
position_dodge(width = bw/2) +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
?position_dodge
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance_cosine = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)+
(trait.3.ann * trait.3.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2 + trait.3.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2 + trait.3.wentworth^2))
,
distance_euclid = sqrt((trait.1.ann - trait.1.wentworth)^2 +
(trait.2.ann - trait.2.wentworth)^2 +
(trait.3.ann - trait.3.wentworth)^2)
) %>%
filter(chapter != 0) -> distance_df
distance_df %>%
ggplot(aes(chapter,distance_euclid)) +
geom_area(na.rm = T) +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance_cosine = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)+
(trait.3.ann * trait.3.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2 + trait.3.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2 + trait.3.wentworth^2))
,
distance_euclid = sqrt((trait.1.ann - trait.1.wentworth)^2 +
(trait.2.ann - trait.2.wentworth)^2 +
(trait.3.ann - trait.3.wentworth)^2) %>% ifelse(. > 0,.,0)
) %>%
filter(chapter != 0) -> distance_df
distance_df %>%
ggplot(aes(chapter,distance_euclid)) +
geom_area(na.rm = T) +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance_cosine = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)+
(trait.3.ann * trait.3.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2 + trait.3.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2 + trait.3.wentworth^2))
,
distance_euclid = sqrt((trait.1.ann - trait.1.wentworth)^2 +
(trait.2.ann - trait.2.wentworth)^2 +
(trait.3.ann - trait.3.wentworth)^2) %>%
{ifelse(is.na(.),.,0)}
) %>%
filter(chapter != 0) -> distance_df
distance_df %>%
ggplot(aes(chapter,distance_euclid)) +
geom_area(na.rm = T) +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance_cosine = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)+
(trait.3.ann * trait.3.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2 + trait.3.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2 + trait.3.wentworth^2))
,
distance_euclid = sqrt((trait.1.ann - trait.1.wentworth)^2 +
(trait.2.ann - trait.2.wentworth)^2 +
(trait.3.ann - trait.3.wentworth)^2) %>%
{ifelse(is_null(.),.,0)}
) %>%
filter(chapter != 0) -> distance_df
distance_df$distance_euclid
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance_cosine = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)+
(trait.3.ann * trait.3.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2 + trait.3.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2 + trait.3.wentworth^2))
,
distance_euclid = sqrt((trait.1.ann - trait.1.wentworth)^2 +
(trait.2.ann - trait.2.wentworth)^2 +
(trait.3.ann - trait.3.wentworth)^2) %>%
{ifelse(is_null(.),0,.)}
) %>%
filter(chapter != 0) -> distance_df
distance_df %>%
ggplot(aes(chapter,distance_euclid)) +
geom_area(na.rm = T) +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
distance_df$distance_euclid
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance_cosine = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)+
(trait.3.ann * trait.3.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2 + trait.3.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2 + trait.3.wentworth^2))
,
distance_euclid = sqrt((trait.1.ann - trait.1.wentworth)^2 +
(trait.2.ann - trait.2.wentworth)^2 +
(trait.3.ann - trait.3.wentworth)^2) %>%
{ifelse(is.na(.),0,.)}
) %>%
filter(chapter != 0) -> distance_df
distance_df$distance_euclid
distance_df %>%
ggplot(aes(chapter,distance_euclid)) +
geom_area(na.rm = T) +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance_cosine = ((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)+
(trait.3.ann * trait.3.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2 + trait.3.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2 + trait.3.wentworth^2))
,
distance_euclid = sqrt((trait.1.ann - trait.1.wentworth)^2 +
(trait.2.ann - trait.2.wentworth)^2 +
(trait.3.ann - trait.3.wentworth)^2)
) %>%
filter(chapter != 0) -> distance_df
distance_df$distance_euclid %<>%
{ifelse(is.na(.),0,.)}
distance_df$distance_cosine %<>%
{ifelse(is.na(.),0,.)}
distance_df %>%
ggplot(aes(chapter,distance_euclid)) +
geom_area(na.rm = T) +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
distance_df %>%
ggplot(aes(chapter,distance_cosine)) +
geom_area(na.rm = T) +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
distance_df %>%
ggplot(aes(chapter,distance_cosine)) +
geom_bar(na.rm = T) +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
?geom_bar
?stat_count
distance_df %>%
ggplot(aes(chapter,distance_cosine)) +
geom_bar(stat = "identity",na.rm = T) +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
distance_df %>%
ggplot(aes(chapter,distance_euclid)) +
geom_bar(stat = "identity",na.rm = T) +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
full_join(data_to_plot %>% filter(label %in% "ann") %>% select(-label,-magnitude),
data_to_plot %>% filter(label %in% "wentworth") %>% select(-label,-magnitude),
by = c("book","chapter"),
suffix = c(".ann",".wentworth")) %>%
mutate(distance_cosine = -((trait.1.ann * trait.1.wentworth) +
(trait.2.ann * trait.2.wentworth)+
(trait.3.ann * trait.3.wentworth)) /
((trait.1.ann^2 + trait.2.ann^2 + trait.3.ann^2) *
(trait.1.wentworth^2 + trait.2.wentworth^2 + trait.3.wentworth^2))
,
distance_euclid = sqrt((trait.1.ann - trait.1.wentworth)^2 +
(trait.2.ann - trait.2.wentworth)^2 +
(trait.3.ann - trait.3.wentworth)^2)
) %>%
filter(chapter != 0) -> distance_df
distance_df$distance_euclid %<>%
{ifelse(is.na(.),0,.)}
distance_df$distance_cosine %<>%
{ifelse(is.na(.),0,.)}
distance_df %>%
ggplot(aes(chapter,distance_cosine)) +
geom_bar(stat = "identity",na.rm = T) +
theme_minimal() +
ggtitle("Persuasion's word universe") +
labs(x="x",y="distance Anne <-> Wentworth")
